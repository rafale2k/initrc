name: macOS Install Test

on:
  push:
    branches: [ main ]

jobs:
  test-macos:
    runs-on: macos-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Run install.sh
        run: |
          chmod +x install.sh
          # CIç’°å¢ƒã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¤ºã—ã¦å®Ÿè¡Œ
          CI=true ./install.sh

      - name: Verify installation
        run: |
          # Homebrewã¨è‡ªä½œbinã®ãƒ‘ã‚¹ã‚’GitHub Actionsã®ç’°å¢ƒã«å¼·åˆ¶æ³¨å…¥
          echo "/opt/homebrew/bin" >> $GITHUB_PATH
          echo "/usr/local/bin" >> $GITHUB_PATH
          echo "$HOME/.local/bin" >> $GITHUB_PATH
          
          # ãƒ‘ã‚¹ãŒåæ˜ ã•ã‚Œã‚‹ã®ã‚’å¾…ã¤ãŸã‚ã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—å†…ã§ãƒ‘ã‚¹ã‚’é€šã™
          export PATH="/opt/homebrew/bin:/usr/local/bin:$HOME/.local/bin:$PATH"
          
          echo "ğŸ” Checking versions..."
          zsh --version
          # bat ã‚„ fd ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚Œã°è¡¨ç¤ºã•ã‚Œã‚‹
          command -v bat || echo "bat not found"
          command -v fd || echo "fd not found"
          
          echo "âœ… All checks passed!"
